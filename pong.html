<html>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <script>
        var canvas;
        var canvasContext;
        
        //ball related variables
        var ballX = 50;
        var ballSpeedX = 10;
        var ballY = 50;
        var ballSpeedY = 4;
        
        //paddle related variables and constants
        var playerPaddleY = 250;
        var computerPaddleY = 250;
        const PADDLE_HEIGHT = 100;
        const PADDLE_THICKNESS = 10;
        
        function getMousePosition(evt) {
            var rect = canvas.getBoundingClientRect();
            var root = document.documentElement;
            var mouseX = evt.clientX - rect.left - root.scrollLeft;
            var mouseY = evt.clientY - rect.top - root.scrollTop;
            
            return {
                x : mouseX,
                y : mouseY
            };
        }
        
        window.onload = function () {
            console.log("Hello World!");
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');
            
            var framesPerSecond = 30;
            setInterval(function() {
                move();
                draw();
            }, 1000/framesPerSecond);
            
            canvas.addEventListener('mousemove',
                function(evt) {
                    var mousePosition = getMousePosition(evt);
                    playerPaddleY = mousePosition.y-(PADDLE_HEIGHT/2);
            });
        }
        
        function ballReset() {
            ballSpeedX = -ballSpeedX;
            ballX = canvas.width/2;
            ballY = canvas.height/2;
        }
        
        function computerMovement() {
            if(computerPaddleY < ballY) {
                computerPaddleY += 6;
            }else {
                computerPaddleY -= 6;
            }
        }
        
        function move() {
            computerMovement();
            
            ballX = ballX + ballSpeedX;
            
            if(ballX >= canvas.width) {
//                ballSpeedX = -ballSpeedX;
                if(ballY > computerPaddleY && ballY < computerPaddleY+PADDLE_HEIGHT) {
                    ballSpeedX = -ballSpeedX;
                }else {
                    ballReset();
                }
            }
            
            if(ballX <= 0) {
                if(ballY > playerPaddleY && ballY < playerPaddleY+PADDLE_HEIGHT) {
                    ballSpeedX = -ballSpeedX;
                }else {
                    ballReset();
                }
            }
            
            ballY = ballY + ballSpeedY;
            
            if(ballY >= canvas.height) {
                ballSpeedY = -ballSpeedY;
            }
            
            if(ballY <= 0) {
                ballSpeedY = -ballSpeedY;
            }
        }
        
        function draw() {
            //drawing the background
            stylingRect(0, 0, canvas.width, canvas.height, 'black');
            
            //drawing the player paddle
            stylingRect(0, playerPaddleY, PADDLE_THICKNESS, PADDLE_HEIGHT, 'white');
            
            //drawing the computer paddle
            stylingRect((canvas.width - PADDLE_THICKNESS), computerPaddleY, PADDLE_THICKNESS, PADDLE_HEIGHT, 'white');
            
            //drawing the ball
            drawCircle(ballX, ballY, 10, 'white');
        }
        
        function drawCircle(centerX, centerY, radius, color) {
            canvasContext.fillStyle = color;
            canvasContext.beginPath();
            canvasContext.arc(centerX, centerY, radius, 0, Math.PI*2, true);
            canvasContext.fill();
        }
        
        function stylingRect(leftX, topY, width, height, color) {
            canvasContext.fillStyle = color;
            canvasContext.fillRect(leftX, topY, width, height);
        }
    </script>
</html>
